
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ze.EFE - Nossas Salas</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
<header class="header">
  <h1 class="logo">Ze.EFE</h1>
  <nav>
    <a href="index.html">Início</a>
    <a href="salas.html" aria-current="page">Salas</a>
    <a href="pre-reserva.html">Pré-Reserva</a>
    <a href="clientes.html">Área do Cliente</a>
  </nav>
</header>

<main>
  <section class="hero">
    <h2>Nossas Salas</h2>
    <p>Espaços completos e prontos para receber suas ideias mais inspiradoras</p>
  </section>

  <section class="filters" aria-label="Filtros de capacidade">
    <button data-filter="all" class="filter-btn active">Todas</button>
    <button data-filter="up-to-10" class="filter-btn">Até 10 pessoas</button>
    <button data-filter="11-20" class="filter-btn">11-20 pessoas</button>
    <button data-filter="over-20" class="filter-btn">Mais de 20</button>
  </section>

  <section class="cards" id="rooms-container" aria-live="polite" aria-atomic="true">
    <!-- Cards de salas serão inseridos aqui -->
  </section>
</main>

<div class="modal-overlay" id="roomModal" aria-hidden="true">
  <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="roomModalTitle">
    <button class="modal-close" type="button" aria-label="Fechar" id="roomModalClose">&times;</button>
    <div class="modal-body">
      <div class="modal-gallery" id="roomModalGallery"></div>
      <div class="modal-info">
        <h2 id="roomModalTitle"></h2>
        <p id="roomModalDescription"></p>
        <dl class="modal-details">
          <div><dt>Capacidade</dt><dd id="roomModalCapacity"></dd></div>
          <div><dt>Status</dt><dd id="roomModalStatus"></dd></div>
          <div><dt>Localização</dt><dd id="roomModalLocation"></dd></div>
          <div><dt>Valor diário</dt><dd id="roomModalRate"></dd></div>
        </dl>
        <div id="roomModalAmenities" class="modal-amenities"></div>
      </div>
    </div>
    <div class="modal-footer">
      <a id="roomModalReserve" class="btn btn-primary" href="#">Reservar diária</a>
      <button class="btn btn-secondary" type="button" id="roomModalCloseFooter">Fechar</button>
    </div>
  </div>
</div>

<footer>
  <p>Contato: contato@zeefe.com | (11) 1234-5678</p>
  <p>Endereço: Moema, São Paulo - SP</p>
  <p><a href="#">Instagram</a> | <a href="#">LinkedIn</a></p>
  <p>© 2025 Ze.EFE - Todos os direitos reservados</p>
</footer>

<script src="scripts/components/carousel.js" defer></script>
<script src="scripts/salas.js" defer></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const roomsContainer = document.getElementById('rooms-container');
  const filterButtons = document.querySelectorAll('.filter-btn');

  let roomsData = [];

  function createRoomCard(room) {
    const statusColors = {
      ativo: 'green',
      manutencao: 'orange',
      desativada: 'red'
    };
    const statusColor = statusColors[room.status] || 'gray';
    const capacityLabel = `Capacidade: ${room.capacity} pessoa${room.capacity > 1 ? 's' : ''}`;
    const dailyRate = parseFloat(room.daily_rate).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' }) + '/dia';

    const card = document.createElement('article');
    card.className = 'card';
    card.innerHTML = `
      <div class="photo" style="background-image: linear-gradient(135deg, #1D413A 0%, #ABA198 100%); height: 200px;"></div>
      <h4>${room.name}</h4>
      <p>${capacityLabel}</p>
      <span class="status-badge" style="background-color:${statusColor}">${room.status === 'ativo' ? 'Disponível' : room.status === 'manutencao' ? 'Em Manutenção' : 'Desativada'}</span>
      <p class="price">${dailyRate}</p>
      <a href="pre-reserva.html?room=${encodeURIComponent(room.id)}" class="btn btn-primary${room.status !== 'ativo' ? ' disabled' : ''}"${room.status !== 'ativo' ? ' tabindex="-1" aria-disabled="true"' : ''}>Reserve Esta Sala</a>
    `;
    return card;
  }

  function renderRooms(filter) {
    roomsContainer.innerHTML = '';
    let filteredRooms = roomsData;
    switch (filter) {
      case 'up-to-10':
        filteredRooms = roomsData.filter(r => r.capacity <= 10);
        break;
      case '11-20':
        filteredRooms = roomsData.filter(r => r.capacity >= 11 && r.capacity <= 20);
        break;
      case 'over-20':
        filteredRooms = roomsData.filter(r => r.capacity > 20);
        break;
    }

    if (filteredRooms.length === 0) {
      roomsContainer.innerHTML = '<p>Nenhuma sala encontrada para esse filtro.</p>';
      return;
    }

    filteredRooms.forEach(room => {
      const card = createRoomCard(room);
      roomsContainer.appendChild(card);
    });
  }

  filterButtons.forEach(button => {
    button.addEventListener('click', () => {
      filterButtons.forEach(btn => btn.classList.remove('active'));
      button.classList.add('active');
      renderRooms(button.dataset.filter);
    });
  });

  async function loadRooms() {
    try {
      const response = await fetch('/api/public_rooms.php');
      if (!response.ok) throw new Error('Erro na requisição');
      const json = await response.json();
      if (!json.success) throw new Error(json.error || 'Erro no servidor');
      roomsData = json.data;
      renderRooms('all');
    } catch (error) {
      roomsContainer.innerHTML = `<p>Erro ao carregar salas: ${error.message}</p>`;
    }
  }
  loadRooms();
});
</script>


</body>
</html>
